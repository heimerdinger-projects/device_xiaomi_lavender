#
# Copyright (C) 2022 Paranoid Android
#
# SPDX-License-Identifier: Apache-2.0
#

on boot
    # GPU boost
    chmod 0660 /sys/class/kgsl/kgsl-3d0/min_pwrlevel

on property:vendor.post_boot.parsed=1
    # Configure scheduler parameters
    write /proc/sys/kernel/sched_downmigrate 85
    write /proc/sys/kernel/sched_upmigrate 95
    write /proc/sys/kernel/sched_autogroup_enabled 0
    write /proc/sys/kernel/sched_walt_rotate_big_tasks 0

    # Disable Core control
    write /sys/devices/system/cpu/cpu0/core_ctl/enable 0
    write /sys/devices/system/cpu/cpu6/core_ctl/enable 0
    
    # Enable idle state listener
    write /sys/class/drm/card0/device/idle_encoder_mask 1
    write /sys/class/drm/card0/device/idle_timeout_ms 100
